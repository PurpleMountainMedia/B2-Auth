webpackJsonp([20],{PZK7:function(e,t,o){var s=o("pjoC");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);o("rjj0")("7545ea0e",s,!0,{})},QL0i:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{},[o("el-row",{attrs:{gutter:10}},[o("el-col",[o("p",[o("strong",[e._v(e._s(e.__("Choose School")))])]),e._v(" "),o("hr")])],1),e._v(" "),e.needsSchool?o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{md:12}},[o("el-form-item",{attrs:{label:e.__("School")}},[o("el-select",{attrs:{"value-key":"id"},model:{value:e.form.school,callback:function(t){e.$set(e.form,"school",t)},expression:"form.school"}},e._l(e.schools,function(t){return o("el-option",{key:t.id,attrs:{value:t,label:t.name}},[e._v("\n            "+e._s(t.name)+" | "+e._s(t.pupil_count)+" pupils\n          ")])}))],1)],1)],1):e._e(),e._v(" "),e.licencePlans.length>0?o("el-row",{attrs:{gutter:10}},[o("el-col",[o("p",[o("strong",[e._v(e._s(e.__("Choose Plan")))])]),e._v(" "),o("hr")])],1):e._e(),e._v(" "),e.licencePlans.length>0?o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{md:24}},[o("p",[e._v(e._s(e.__("Showing plans for schools with pupil counts over"))+": "),o("strong",[e._v(e._s(e.form.school.pupil_count))])])]),e._v(" "),e._l(e.licencePlans,function(e){return o("el-col",{key:e.id,attrs:{md:12}},[o("b2-licence-plan-card",{attrs:{plan:e}})],1)})],2):e._e()],1)},staticRenderFns:[]}},S8xj:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("UMHT");t.default={name:"B2LicenceFields",components:{B2LicencePlanCard:function(){return o.e(27).then(o.bind(null,"I1OL"))}},props:{form:{type:Object,required:!0},needsSchool:{type:Boolean,required:!1,default:function(){return!0}}},data:function(){return{errors:{},schools:{},licencePlans:{}}},watch:{"form.school":function(){this.getLicencePlans()}},mounted:function(){this.getSchools()},methods:{getSchools:function(){var e=this;s.a.get({path:"schools",params:{limit:1e6,include:["schools.extra"]}}).then(function(t){e.schools=t.data}).catch(function(t){e.errors=t})},getLicencePlans:function(){var e=this,t=this.form.school.pupil_count;s.a.get({path:"licence-plans",params:{limit:1e6,minPupils:t,maxPupils:t,minSchools:1,maxSchools:1,include:["licencePlans.extra"]}}).then(function(t){e.licencePlans=t.data}).catch(function(t){e.errors=t})}}}},UMHT:function(e,t,o){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=window.b2Systems.site_url+"/"+window.b2Systems.api_prefix+"/",n="We could not access the server at this time. Please try again. If the issue persists, please contact support.";t.a={get:function(e){return e.params||(e.params={}),e.url||(e.url=r+e.path),e.params.limit=e.params.limit?e.params.limit:15,e.params.ascending=e.params.ascending?e.params.ascending:0,e.params.orderBy=e.params.orderBy?e.params.orderBy:"id",console.log("API Get: "+e.url),new Promise(function(t,o){window.axios.get(e.url,{params:e.params}).then(function(e){t(e.data)}).catch(function(e){o(this.errorAdapter(e))}.bind(this))}.bind(this))},delete:function(e){return e.url||(e.url=r+e.path),console.log("API Delete: "+e.url),new Promise(function(t,o){window.axios.delete(e.url,e.params?{params:e.params}:"").then(function(e){t(e.data)}).catch(function(e){o(this.errorAdapter(e))}.bind(this))}.bind(this))},persist:function(e,t){return t.params||(t.params={}),t.url||(t.url=r+t.path),console.log("API "+e+": "+t.url),new Promise(function(o,s){window.axios[e](t.url,t.object,t.params).then(function(e){o(e.data)}).catch(function(e){s(this.errorAdapter(e))}.bind(this))}.bind(this))},errorAdapter:function(e){var t=(e=((e=e||{}).response?e.response:{}).status?e.response:e).data?e.data:e.message;return console.error("API Error:"),console.log(e),console.error("API Error Data"),console.log(t),e?"object"===(void 0===t?"undefined":s(t))&&422===e.status?t:403===e.status?{message:"We could not complete the request, because you are not authorised to do so.",code:e.status}:{message:n,errors:{server:["Please use this error code in any suppot queries. Error Code: "+e.status]},code:e.status}:{message:n,errors:{server:e.message},code:e.status}}}},pjoC:function(e,t,o){(e.exports=o("FZ+f")(!1)).push([e.i,"",""])},q0si:function(e,t,o){var s=o("VU/8")(o("S8xj"),o("QL0i"),!1,function(e){o("PZK7")},null,null);e.exports=s.exports}});
//# sourceMappingURL=b2-licence-fields.js.map